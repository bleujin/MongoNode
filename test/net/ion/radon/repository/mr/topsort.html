
<html>
<body>

<script>

	(function() {
		var oldalert = window.alert ;
		window.alert = function(){
			oldalert(Array.prototype.join.call(arguments, '\n')) ;
		}
	})() ;


	var arrays = [1,2,3,4,5,6,7,8,1] ;
	Array.prototype.shuffle = function(){
		this.sort(function(){return Math.random()*2-1;}); 
	}
	arrays.shuffle() ; 

	Array.prototype.myEach = function(fun, thisp){
	    if (typeof fun != "function") throw new TypeError();

	    var result = true ;
	    for (var i = 0; i < this.length; i++){
	      if (i in this) {
		      var varResult = fun.call(thisp, this[i], i, this);
		      if (varResult == false) {
			      result = varResult ;
			      break ;
		      }
	      }
	    }
	    return result ;
	};

	Array.prototype.topSort = function(limit, compareFn){
		var result = [] ;
		var maxValue ;
		Array.prototype.myEach.call(this, function(sourceEle, sourceIndex, sourceArray) {
			var notInRange = result.myEach(function(element, index, array){
				if (compareFn(sourceEle, element) <= 0 && index <= limit) {
					result.splice(index, 0, sourceEle) ;
					return false ;
				}
			}, result) ;
			if (notInRange && result.length < limit) { 
				result.push(sourceEle)
			} ;
			result = result.slice(0, limit) ;
		}, this) ;
		return result ;
	}

	alert(arrays.topSort(4, function(left, right) {return (left - right) ;}), arrays) ;
	
	
</script>
</body>
</html>
